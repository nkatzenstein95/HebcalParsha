<script>
  async function loadHebcal() {
    const t = new Date();
    const yyyy = t.getFullYear(), mm = t.getMonth() + 1, dd = t.getDate();
    const dateUrl = `https://www.hebcal.com/converter?cfg=json&gy=${yyyy}&gm=${mm}&gd=${dd}&g2h=1`;
    const start = t.toISOString().split("T")[0];
    const t2 = new Date(t);
    t2.setDate(t2.getDate() + 7);
    const end = t2.toISOString().split("T")[0];
    const parshaUrl = `https://www.hebcal.com/hebcal?cfg=json&start=${start}&end=${end}&maj=on&ss=on&mf=on&v=1&c=on`;

    try {
      const [dateRes, parRes] = await Promise.all([
        fetch(dateUrl), fetch(parshaUrl)
      ]);
      const dateData = await dateRes.json();
      const parData = await parRes.json();

      document.getElementById("date").textContent = dateData.hebrew;
      const par = parData.items.find(i => i.category === "parashat");
      document.getElementById("parsha").textContent = par ? `פרשת ${par.hebrew}` : "לא נמצאה פרשה לשבוע זה";
    } catch (e) {
      document.getElementById("date").textContent = "שגיאה בטעינת התאריך";
      document.getElementById("parsha").textContent = "שגיאה בפרשת השבוע";
      console.error(e);
    }
  }

  document.addEventListener("DOMContentLoaded", loadHebcal);
</script>
